<!DOCTYPE html>
<html>
<head>
    <title>Leaflet Map</title>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Include Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

    <!-- Include Leaflet JS -->
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <!-- Leaflet.TileLayer.GlColorScale
    <script src="https://unpkg.com/leaflet.tilelayer.glcolorscale/dist/bundle.min.js"></script> -->

    <style>
        #mapid { 
            position: absolute;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            height: 100%;
        }
    </style>
</head>
<body>
    <div id="mapid"></div>

<script>
    // const { GLColorScale } = L.TileLayer;
    // var map = L.map('mapid').setView([51.505, -0.09], 13);
    var map = L.map('mapid');

    console.log("tileserver_prefix - {{ cog_tileserver_url_prefix }}")
    console.log("fire_event_name - {{ fire_event_name }}")
    console.log("fire metadata")
    var fireMetadata = JSON.parse({{fire_metadata_json | tojson | safe}});
    console.log(fireMetadata);

    var fire_bounds = [[fireMetadata.bounds[1], fireMetadata.bounds[0]], [fireMetadata.bounds[3], fireMetadata.bounds[2]]]
    console.log("fire bounds - ", fire_bounds)

    // Add base map
    L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', {
        attribution: 'Â© OpenStreetMap contributors'
    }).addTo(map);

    // Create a new L.TileLayer.GLColorScale layer
    // const tileLayer = new GLColorScale({
    //     url: '{{ cog_tileserver_url_prefix | safe }}{"thresholds":{"0.045":100,"0.222":150,"0.8":200}}',
    //     colorScale: [
    //         { offset: -.2, color: 'rgb(255, 0, 0)', label: 'zero' },
    //         { offset: .2, color: 'rgb(0, 0, 255)', label: 'one' },
    //     ],
    //     nodataValue: 0,
    // }).addTo(map);

    L.tileLayer('{{ cog_tileserver_url_prefix | safe }}{"thresholds":{"0.045":100,"0.222":150,"0.8":200}}', {
        maxZoom: 20,
    }).addTo(map);

    // Center map on fire, based on `bounds` metadata
    map.fitBounds(fire_bounds);
</script>

</body>
</html>